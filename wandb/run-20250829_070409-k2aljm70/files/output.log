                                                                                                                                                                                 
{'loss': 3.3513, 'grad_norm': 9.4375, 'learning_rate': 0.0, 'epoch': 0.0}
{'loss': 3.5225, 'grad_norm': 9.3125, 'learning_rate': 1.7647058823529412e-06, 'epoch': 0.0}
{'loss': 3.5041, 'grad_norm': 10.6875, 'learning_rate': 3.5294117647058825e-06, 'epoch': 0.0}
{'loss': 3.3867, 'grad_norm': 9.6875, 'learning_rate': 5.294117647058824e-06, 'epoch': 0.0}
{'loss': 3.2994, 'grad_norm': 9.375, 'learning_rate': 7.058823529411765e-06, 'epoch': 0.0}
{'loss': 3.4072, 'grad_norm': 9.8125, 'learning_rate': 8.823529411764707e-06, 'epoch': 0.0}
{'loss': 3.372, 'grad_norm': 9.1875, 'learning_rate': 1.0588235294117648e-05, 'epoch': 0.0}
{'loss': 3.5083, 'grad_norm': 10.4375, 'learning_rate': 1.2352941176470587e-05, 'epoch': 0.0}
{'loss': 3.349, 'grad_norm': 8.75, 'learning_rate': 1.411764705882353e-05, 'epoch': 0.01}
{'loss': 3.4109, 'grad_norm': 9.3125, 'learning_rate': 1.5882352941176473e-05, 'epoch': 0.01}
{'loss': 3.5155, 'grad_norm': 9.0625, 'learning_rate': 1.7647058823529414e-05, 'epoch': 0.01}
{'loss': 3.4117, 'grad_norm': 7.90625, 'learning_rate': 1.9411764705882355e-05, 'epoch': 0.01}
{'loss': 3.3381, 'grad_norm': 7.125, 'learning_rate': 2.1176470588235296e-05, 'epoch': 0.01}
{'loss': 3.3496, 'grad_norm': 7.90625, 'learning_rate': 2.2941176470588233e-05, 'epoch': 0.01}
{'loss': 3.5191, 'grad_norm': 7.34375, 'learning_rate': 2.4705882352941174e-05, 'epoch': 0.01}
{'loss': 3.3612, 'grad_norm': 6.1875, 'learning_rate': 2.647058823529412e-05, 'epoch': 0.01}
{'loss': 3.52, 'grad_norm': 5.75, 'learning_rate': 2.823529411764706e-05, 'epoch': 0.01}
{'loss': 3.456, 'grad_norm': 5.21875, 'learning_rate': 3e-05, 'epoch': 0.01}
{'loss': 3.3945, 'grad_norm': 5.5, 'learning_rate': 2.999997237746601e-05, 'epoch': 0.01}
{'loss': 3.2916, 'grad_norm': 4.3125, 'learning_rate': 2.999988950996577e-05, 'epoch': 0.01}
{'loss': 3.4865, 'grad_norm': 4.3125, 'learning_rate': 2.9999751397804487e-05, 'epoch': 0.01}
{'loss': 3.3763, 'grad_norm': 4.96875, 'learning_rate': 2.9999558041490823e-05, 'epoch': 0.01}
{'loss': 3.3411, 'grad_norm': 4.34375, 'learning_rate': 2.999930944173692e-05, 'epoch': 0.01}
{'loss': 3.507, 'grad_norm': 4.375, 'learning_rate': 2.9999005599458358e-05, 'epoch': 0.01}
{'loss': 3.3858, 'grad_norm': 4.09375, 'learning_rate': 2.9998646515774198e-05, 'epoch': 0.02}
  File "/home/jpaulsen/repos/mimi-smollm/train_qa.py", line 165, in <module>                                                                                                     
{'eval_loss': 3.3827333450317383, 'eval_runtime': 5.3906, 'eval_samples_per_second': 186.066, 'eval_steps_per_second': 23.374, 'epoch': 0.02}
{'loss': 3.4273, 'grad_norm': 4.15625, 'learning_rate': 2.9998232192006944e-05, 'epoch': 0.02}
{'loss': 3.3298, 'grad_norm': 3.859375, 'learning_rate': 2.9997762629682557e-05, 'epoch': 0.02}
{'loss': 3.1432, 'grad_norm': 3.984375, 'learning_rate': 2.999723783053043e-05, 'epoch': 0.02}
{'loss': 3.3868, 'grad_norm': 3.578125, 'learning_rate': 2.9996657796483406e-05, 'epoch': 0.02}
{'loss': 3.3227, 'grad_norm': 4.15625, 'learning_rate': 2.999602252967775e-05, 'epoch': 0.02}
{'loss': 3.3546, 'grad_norm': 3.984375, 'learning_rate': 2.999533203245316e-05, 'epoch': 0.02}
{'loss': 3.3589, 'grad_norm': 4.375, 'learning_rate': 2.999458630735273e-05, 'epoch': 0.02}
{'loss': 3.2654, 'grad_norm': 4.25, 'learning_rate': 2.9993785357122968e-05, 'epoch': 0.02}
{'loss': 3.4131, 'grad_norm': 4.25, 'learning_rate': 2.9992929184713794e-05, 'epoch': 0.02}
{'loss': 3.2586, 'grad_norm': 3.734375, 'learning_rate': 2.999201779327847e-05, 'epoch': 0.02}
{'loss': 3.3822, 'grad_norm': 3.671875, 'learning_rate': 2.9991051186173682e-05, 'epoch': 0.02}
{'loss': 3.4223, 'grad_norm': 3.90625, 'learning_rate': 2.9990029366959425e-05, 'epoch': 0.02}
{'loss': 3.2975, 'grad_norm': 3.328125, 'learning_rate': 2.9988952339399077e-05, 'epoch': 0.02}
{'loss': 3.48, 'grad_norm': 3.234375, 'learning_rate': 2.9987820107459332e-05, 'epoch': 0.02}
{'loss': 3.232, 'grad_norm': 3.25, 'learning_rate': 2.9986632675310203e-05, 'epoch': 0.02}
{'loss': 3.2659, 'grad_norm': 2.40625, 'learning_rate': 2.9985390047325013e-05, 'epoch': 0.02}
{'loss': 3.3912, 'grad_norm': 2.25, 'learning_rate': 2.9984092228080363e-05, 'epoch': 0.03}
{'loss': 3.321, 'grad_norm': 2.0, 'learning_rate': 2.9982739222356127e-05, 'epoch': 0.03}
{'loss': 3.3666, 'grad_norm': 2.328125, 'learning_rate': 2.9981331035135433e-05, 'epoch': 0.03}
    main()
  File "/home/jpaulsen/repos/mimi-smollm/train_qa.py", line 160, in main
    trainer.train()
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 2238, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 2533, in _inner_training_loop
    batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches, args.device)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 5355, in get_batch_samples
    batch_samples.append(next(epoch_iterator))
                         ^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/accelerate/data_loader.py", line 579, in __iter__
    next_batch = next(dataloader_iter)
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 50, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2863, in __getitems__
    batch = self.__getitem__(keys)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2859, in __getitem__
    return self._getitem(key)
           ^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2841, in _getitem
    formatted_output = format_table(
                       ^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 657, in format_table
    return formatter(pa_table, query_type=query_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 414, in __call__
    return self.format_batch(pa_table)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 470, in format_batch
    batch = self.python_arrow_extractor().extract_batch(pa_table)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jpaulsen/repos/mimi-smollm/.venv/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 149, in extract_batch
    return pa_table.to_pydict()
           ^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
